{"remainingRequest":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liyaodong/Documents/VitalInsight/eladmin-web/src/views/tools/email/send.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/src/views/tools/email/send.vue","mtime":1744855950683},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":1744860344598},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/babel-loader/lib/index.js","mtime":1744860345141},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":1744860344598},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/vue-loader/lib/index.js","mtime":1744860343909}],"contextDependencies":[],"result":["\nimport { send } from '@/api/tools/email'\nimport { upload } from '@/utils/upload'\nimport { mapGetters } from 'vuex'\nimport E from 'wangeditor'\nexport default {\n  name: 'Index',\n  data() {\n    return {\n      loading: false, form: { subject: '', tos: '', content: '' },\n      rules: {\n        subject: [\n          { required: true, message: '标题不能为空', trigger: 'blur' }\n        ],\n        tos: [\n          { required: true, message: '收件人不能为空', trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'imagesUploadApi',\n      'baseApi'\n    ])\n  },\n  mounted() {\n    const _this = this\n    var editor = new E(this.$refs.editor)\n    // 自定义菜单配置\n    editor.config.zIndex = 10\n    // 文件上传\n    editor.config.customUploadImg = function(files, insert) {\n      // files 是 input 中选中的文件列表\n      // insert 是获取图片 url 后，插入到编辑器的方法\n      files.forEach(image => {\n        upload(_this.imagesUploadApi, image).then(res => {\n          const data = res.data\n          const url = _this.baseApi + '/file/' + data.type + '/' + data.realName\n          insert(url)\n        })\n      })\n    }\n    editor.config.onchange = (html) => {\n      this.form.content = html\n    }\n    editor.create()\n  },\n  methods: {\n    doSubmit() {\n      this.$refs['form'].validate((valid) => {\n        if (valid) {\n          this.loading = true\n          send(this.form).then(res => {\n            this.$notify({\n              title: '发送成功',\n              type: 'success',\n              duration: 2500\n            })\n            this.loading = false\n          }).catch(err => {\n            this.loading = false\n            console.log(err.response.data.message)\n          })\n        } else {\n          return false\n        }\n      })\n    }\n  }\n}\n",null]}