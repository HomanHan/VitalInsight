{"remainingRequest":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/babel-loader/lib/index.js!/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/eslint-loader/index.js??ref--13-0!/Users/liyaodong/Documents/VitalInsight/eladmin-web/src/mixins/crud.js","dependencies":[{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/src/mixins/crud.js","mtime":1744855950676},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/babel.config.js","mtime":1744855950655},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":1744860344598},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/babel-loader/lib/index.js","mtime":1744860345141},{"path":"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/eslint-loader/index.js","mtime":1744860344682}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _defineProperty2 = _interopRequireDefault(require(\"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/@babel/runtime-corejs2/helpers/defineProperty.js\"));\nrequire(\"core-js/modules/web.dom.iterable\");\nrequire(\"core-js/modules/es6.object.keys\");\nrequire(\"regenerator-runtime/runtime\");\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"/Users/liyaodong/Documents/VitalInsight/eladmin-web/node_modules/@babel/runtime-corejs2/helpers/asyncToGenerator.js\"));\nvar _data = require(\"@/api/data\");\nvar _utils = require(\"@/utils\");\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nvar _default = exports.default = {\n  data: function data() {\n    return {\n      // 表格数据\n      data: [],\n      // 页码\n      page: 1,\n      // 每页数据条数\n      size: 10,\n      // 总数据条数\n      total: 0,\n      // 请求数据的url\n      url: '',\n      // 查询数据的参数\n      params: {},\n      // 待查询的对象\n      query: {},\n      // 等待时间\n      time: 50,\n      // 是否为新增类型的表单\n      isAdd: false,\n      // 导出的 Loading\n      downloadLoading: false,\n      // 表格 Loading 属性\n      loading: true,\n      // 删除 Loading 属性\n      delLoading: false,\n      delAllLoading: false,\n      // 弹窗属性\n      dialog: false,\n      // Form 表单\n      form: {},\n      // 重置表单\n      resetForm: {},\n      // 标题\n      title: ''\n    };\n  },\n  methods: {\n    parseTime: _utils.parseTime,\n    downloadFile: _utils.downloadFile,\n    init: function () {\n      var _init = (0, _asyncToGenerator2.default)(/*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return this.beforeInit();\n            case 2:\n              if (_context.sent) {\n                _context.next = 4;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 4:\n              return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                _this.loading = true;\n                // 请求数据\n                (0, _data.initData)(_this.url, _this.getQueryParams()).then(function (data) {\n                  _this.total = data.totalElements;\n                  _this.data = data.content;\n                  // time 毫秒后显示表格\n                  setTimeout(function () {\n                    _this.loading = false;\n                  }, _this.time);\n                  resolve(data);\n                }).catch(function (err) {\n                  _this.loading = false;\n                  reject(err);\n                });\n              }));\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }(),\n    beforeInit: function beforeInit() {\n      return true;\n    },\n    getQueryParams: function getQueryParams() {\n      var _this2 = this;\n      // 清除参数无值的情况\n      Object.keys(this.query).length !== 0 && Object.keys(this.query).forEach(function (item) {\n        if (_this2.query[item] === null || _this2.query[item] === '') _this2.query[item] = undefined;\n      });\n      Object.keys(this.params).length !== 0 && Object.keys(this.params).forEach(function (item) {\n        if (_this2.params[item] === null || _this2.params[item] === '') _this2.params[item] = undefined;\n      });\n      return _objectSpread(_objectSpread({\n        page: this.page,\n        size: this.size\n      }, this.query), this.params);\n    },\n    // 改变页码\n    pageChange: function pageChange(e) {\n      this.page = e;\n      this.init();\n    },\n    // 改变每页显示数\n    sizeChange: function sizeChange(e) {\n      this.page = 1;\n      this.size = e;\n      this.init();\n    },\n    // 预防删除第二页最后一条数据时，或者多选删除第二页的数据时，页码错误导致请求无数据\n    dleChangePage: function dleChangePage(size) {\n      if (size === undefined) {\n        size = 1;\n      }\n      if (this.data.length === size && this.page !== 0) {\n        this.page = this.page - 1;\n      }\n    },\n    // 查询方法\n    toQuery: function toQuery() {\n      this.page = 0;\n      this.init();\n    },\n    /**\n     * 通用的提示封装\n     */\n    submitSuccessNotify: function submitSuccessNotify() {\n      this.$notify({\n        title: '提交成功',\n        type: 'success',\n        duration: 2500\n      });\n    },\n    addSuccessNotify: function addSuccessNotify() {\n      this.$notify({\n        title: '新增成功',\n        type: 'success',\n        duration: 2500\n      });\n    },\n    editSuccessNotify: function editSuccessNotify() {\n      this.$notify({\n        title: '编辑成功',\n        type: 'success',\n        duration: 2500\n      });\n    },\n    delSuccessNotify: function delSuccessNotify() {\n      this.$notify({\n        title: '删除成功',\n        type: 'success',\n        duration: 2500\n      });\n    },\n    notify: function notify(title, type) {\n      this.$notify({\n        title: title,\n        type: type,\n        duration: 2500\n      });\n    },\n    /**\n     * 删除前可以调用 beforeDelMethod 做一些操作\n     */\n    beforeDelMethod: function beforeDelMethod() {\n      return true;\n    },\n    /**\n     * 通用的删除\n     */\n    delMethod: function delMethod(id) {\n      var _this3 = this;\n      if (!this.beforeDelMethod()) {\n        return;\n      }\n      this.delLoading = true;\n      this.crudMethod.del(id).then(function () {\n        _this3.delLoading = false;\n        _this3.$refs[id].doClose();\n        _this3.dleChangePage();\n        _this3.delSuccessNotify();\n        _this3.afterDelMethod();\n        _this3.init();\n      }).catch(function () {\n        _this3.delLoading = false;\n        _this3.$refs[id].doClose();\n      });\n    },\n    afterDelMethod: function afterDelMethod() {},\n    /**\n     * 多选删除提示\n     */\n    beforeDelAllMethod: function beforeDelAllMethod() {\n      var _this4 = this;\n      this.$confirm('你确定删除选中的数据吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this4.delAllMethod();\n      });\n    },\n    /**\n     * 多选删除\n     */\n    delAllMethod: function delAllMethod() {\n      var _this5 = this;\n      this.delAllLoading = true;\n      var data = this.$refs.table.selection;\n      var ids = [];\n      for (var i = 0; i < data.length; i++) {\n        ids.push(data[i].id);\n      }\n      this.crudMethod.delAll(ids).then(function () {\n        _this5.delAllLoading = false;\n        _this5.dleChangePage(ids.length);\n        _this5.init();\n        _this5.$notify({\n          title: '删除成功',\n          type: 'success',\n          duration: 2500\n        });\n      }).catch(function () {\n        _this5.delAllLoading = false;\n      });\n    },\n    /**\n     * 显示新增弹窗前可以调用该方法\n     */\n    beforeShowAddForm: function beforeShowAddForm() {},\n    /**\n     * 显示新增弹窗\n     */\n    showAddFormDialog: function showAddFormDialog() {\n      this.isAdd = true;\n      this.resetForm = JSON.parse(JSON.stringify(this.form));\n      this.beforeShowAddForm();\n      this.dialog = true;\n    },\n    /**\n     * 显示编辑弹窗前可以调用该方法\n     */\n    beforeShowEditForm: function beforeShowEditForm(data) {},\n    /**\n     * 显示编辑弹窗\n     */\n    showEditFormDialog: function showEditFormDialog() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      this.isAdd = false;\n      if (data) {\n        this.resetForm = JSON.parse(JSON.stringify(this.form));\n        this.form = JSON.parse(JSON.stringify(data));\n      }\n      this.beforeShowEditForm(data);\n      this.dialog = true;\n    },\n    /**\n     * 新增方法\n     */\n    addMethod: function addMethod() {\n      var _this6 = this;\n      this.crudMethod.add(this.form).then(function () {\n        _this6.addSuccessNotify();\n        _this6.loading = false;\n        _this6.afterAddMethod();\n        _this6.cancel();\n        _this6.init();\n      }).catch(function () {\n        _this6.loading = false;\n        _this6.afterAddErrorMethod();\n      });\n    },\n    /**\n     * 新增后可以调用该方法\n     */\n    afterAddMethod: function afterAddMethod() {},\n    /**\n     * 新增失败后调用该方法\n     */\n    afterAddErrorMethod: function afterAddErrorMethod() {},\n    /**\n     * 通用的编辑方法\n     */\n    editMethod: function editMethod() {\n      var _this7 = this;\n      this.crudMethod.edit(this.form).then(function () {\n        _this7.editSuccessNotify();\n        _this7.loading = false;\n        _this7.afterEditMethod();\n        _this7.cancel();\n        _this7.init();\n      }).catch(function () {\n        _this7.loading = false;\n      });\n    },\n    /**\n     * 编辑后可以调用该方法\n     */\n    afterEditMethod: function afterEditMethod() {},\n    /**\n     * 提交前可以调用该方法\n     */\n    beforeSubmitMethod: function beforeSubmitMethod() {\n      return true;\n    },\n    /**\n     * 提交\n     */\n    submitMethod: function submitMethod() {\n      var _this8 = this;\n      if (!this.beforeSubmitMethod()) {\n        return;\n      }\n      if (this.$refs['form']) {\n        this.$refs['form'].validate(function (valid) {\n          if (valid) {\n            _this8.loading = true;\n            if (_this8.isAdd) {\n              _this8.addMethod();\n            } else _this8.editMethod();\n          }\n        });\n      }\n    },\n    /**\n     * 隐藏弹窗\n     */\n    cancel: function cancel() {\n      this.dialog = false;\n      if (this.$refs['form']) {\n        this.$refs['form'].clearValidate();\n        this.form = this.resetForm;\n      }\n    },\n    /**\n     * 获取弹窗的标题\n     */\n    getFormTitle: function getFormTitle() {\n      return this.isAdd ? \"\\u65B0\\u589E\".concat(this.title) : \"\\u7F16\\u8F91\".concat(this.title);\n    },\n    /**\n     * 通用导出\n     */\n    downloadMethod: function downloadMethod() {\n      var _this9 = this;\n      this.beforeInit();\n      this.downloadLoading = true;\n      (0, _data.download)(this.url + '/download', this.params).then(function (result) {\n        _this9.downloadFile(result, _this9.title + '数据', 'xlsx');\n        _this9.downloadLoading = false;\n      }).catch(function () {\n        _this9.downloadLoading = false;\n      });\n    }\n  }\n};",null]}